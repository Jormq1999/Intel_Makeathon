# AI-Friendly Feedback for `02-integration-guide.md`

**Source Repository:** `/nfs/site/disks/juanpsal_disk_002/iscp-fst/ip-csme`

## 1. Analysis Summary

The `ip-csme` environment is well-structured, making it straightforward to integrate a new UVM test generation agent. The key is to follow the existing patterns for test creation and environment configuration. The integration process will involve creating a new test, modifying the build, and ensuring the generated sequences are correctly started on the virtual sequencer.

## 2. Integration Plan

### 2.1. Create a New Test for the Agent

1.  **Location:** Create a new test file in the `verif/csme_usbr/tests/` directory. For example, `moa_usbr_ai_generated_test.sv`.

2.  **Test Structure:** The new test should extend from the same base class as other tests, likely `usbr_base_test`.

    ```systemverilog
    // In moa_usbr_ai_generated_test.sv
    class moa_usbr_ai_generated_test extends usbr_base_test;
      `uvm_component_utils(moa_usbr_ai_generated_test)

      // The sequence that the AI agent will generate
      ai_generated_top_seq m_seq;

      function new(string name, uvm_component parent);
        super.new(name, parent);
      endfunction

      virtual function void build_phase(uvm_phase phase);
        super.build_phase(phase);
        // Any test-specific configuration can be done here
      endfunction

      virtual task run_phase(uvm_phase phase);
        phase.raise_objection(this);
        m_seq = ai_generated_top_seq::type_id::create("m_seq");
        m_seq.start(m_env.m_vsequencer);
        phase.drop_objection(this);
      endtask
    endclass
    ```

### 2.2. Define the Generated Sequence

1.  **Location:** The AI agent should place the generated sequence in a new file, for example, `verif/csme_usbr/env/seqlib/ai_generated_top_seq.sv`.

2.  **Sequence Structure:** The sequence should extend from `moa_usbr_base_seq` and contain the logic generated by the agent.

    ```systemverilog
    // In ai_generated_top_seq.sv
    class ai_generated_top_seq extends moa_usbr_base_seq;
      `uvm_object_utils(ai_generated_top_seq)

      // Other sequences to be executed
      csme_usbr_init_seq m_init_seq;
      csme_usbr_bulk_data_seq m_bulk_seq;

      function new(string name = "ai_generated_top_seq");
        super.new(name);
      endfunction

      virtual task body();
        // The agent will generate the sequence logic here.
        // Example:
        m_init_seq = csme_usbr_init_seq::type_id::create("m_init_seq");
        m_init_seq.start(p_sequencer);

        m_bulk_seq = csme_usbr_bulk_data_seq::type_id::create("m_bulk_seq");
        `uvm_rand_send(m_bulk_seq)
      endtask
    endclass
    ```

### 2.3. Update the Build System

1.  **Test Lists:** The primary way to include new tests seems to be through test lists in `verif/csme_usbr/tests/testlists/`.

2.  **Action:** Add the path to the new test file (`moa_usbr_ai_generated_test.sv`) to one of the existing `.list` files (e.g., `all.list`) or create a new list for AI-generated tests.

    ```
    // In all.list
    ...
    $(TEST_DIR)/moa_usbr_ai_generated_test.sv
    ```

3.  **File Lists (`.f` files):** If the build system uses `.f` files (like `reusable_verif.f.template`), the agent will need to add the path to the new sequence file (`ai_generated_top_seq.sv`) there.

### 2.4. Running the Test

-   The test can be run using the existing simulation flow, specifying the new test name (`moa_usbr_ai_generated_test`) as the `UVM_TESTNAME`.

## 3. Key Integration Points for the AI Agent

-   **Target Directory for Sequences:** The agent should always place new top-level sequences in `verif/csme_usbr/env/seqlib/`.
-   **Target Directory for Tests:** The agent should place new test files in `verif/csme_usbr/tests/`.
-   **Base Class for Tests:** All new tests must extend `usbr_base_test`.
-   **Base Class for Sequences:** All new sequences should extend `moa_usbr_base_seq`.
-   **Starting Sequences:** The `run_phase` of the test is the correct place to create and `start()` the top-level sequence on the virtual sequencer (`m_env.m_vsequencer`).
-   **Build Integration:** The agent must be aware of the `testlists` directory and be able to add new files to the appropriate list.
